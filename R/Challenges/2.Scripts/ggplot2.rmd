---
title: "Prac"
author: "Basil"
date: "August 16, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
###Package
```{r}
ipk<-function(pkg) {
  new.pkg<-list.of.pkgs[!(list.of.pkgs %in% installed.packages()[,"Package"])]
  if(length(new.pkg)) install.packages(new.pkg,repos='http://cran.us.r-project.org',dependencies =T)
  sapply(pkg,require,character.only=T)
}
list.of.pkgs<-c("ggplot2","dplyr","corrr","magrittr","plotly","shiny")
ipk(list.of.pkgs)
```

```{r cars}

```
### qplot 
```{r}
#base
attach(mpg)
glimpse(mpg) %>% summary()
plot(displ,hwy)
#gglot2
qplot(displ,hwy, data = mpg, col=drv) #scatter
qplot(displ,hwy,data=mpg,geom = c("point","smooth") ) 
qplot(displ, hwy,data=mpg,facets=.~drv)
# facets subsets data & includes two vars separated by ~, left is the rows, right is the cols
qplot(hwy,data=mpg,facets = drv~.,binwidth=2) 
```
```{r}
dat2<-read.csv(file.choose(),header = T)
head(dat2)
qplot(program_code,data=dat2,fill=program_code) #hist
qplot(program_code,data=dat2,geom="density")
qplot(program_code,data=dat2,geom="density",color=program_code) #density plot
```
###ggplot - aes()
```{r}
# aes() is passed either at ggplot(defaults) or specific layer
ggplot(mpg,aes(cyl,hwy)) + geom_point() #1
ggplot(mpg)+geom_point(aes(cyl,displ)) #2
# 3 ways of passing aes()
aes(mpg, cyl, disp) #a
aes_(~mpg,~cyl,~hwy) #b
aes_string("mpg","wt",col="cyl")
#example
ggplot(mtcars)+geom_point(aes_(~mpg,~wt,col=~cyl))
# Tidy plots
scatter_by<-function(data,...) {
  ggplot(data)+geom_point(aes(...))
}
scatter_by(mtcars, disp,drat)

```
<<<<<<< HEAD
### Sub-groups of aes(): colour, fill, alpha
```{r}
# Bar chart example
c<-ggplot(mtcars,aes(factor(cyl)))
# default plotting
c+geom_bar()
# To change the interior colouring use fill aesthetic
c+geom_bar(fill="grey")
#comparing to the colour aesthetic which changes just the bar outline
c+geom_bar(colour="grey")
#combining both colour and fill
c+geom_bar(colour="red",fill="grey")
#The aesthetic fill also takes different colouring scales
#Setting fill equal to a factor variable uses discrete colouring scale
k<-ggplot(mtcars,aes(factor(cyl),fill=factor(vs)))
k+geom_bar()
m<-ggplot(dat,aes(factor(sensitize_method),fill=factor(sensitize_method)))
m+geom_bar()



```
## Sub-groups of aes(col,fil,alpha)
```{r}
#deafault 
bar_by<- function(data,...) {
  ggplot(data) + geom_bar(aes(...))
}
bar_by(mtcars,factor(cyl)) # default
bar_by(mtcars,factor(cyl),colour="black",fill="white") #fill and colour opts 
k<-ggplot(mtcars,aes(factor(cyl),fill=factor(vs)))
k+geom_bar() # fill equals to a factor uses discrete colour scale
m<-ggplot(faithfuld,aes(waiting,eruptions))
m+geom_raster()
m+geom_raster(aes(fill=density)) #cont var as a fill
#geom_point() & geom_line() do not use both aes
b<-ggplot(economics,aes(x=date,y=unemploy))
b+geom_line()
b+geom_line(colour="green")
# for large datasete with overplotting the alpha
df<-data.frame(x=rnorm(5000),y=rnorm(5000))
h<-ggplot(df,aes(x,y))
h+geom_point() #very dark
h+geom_point(alpha=.5) #lighter
h+geom_point(alpha=.1) # even lighter

# Alpha can also be used to add shading
j<-b+geom_line()
j
yrng<-range(economics$unemploy)
j<-j+geom_rect(aes(NULL,NULL,xmin=start,xmax=end,fill=party),ymin=yrng[1],ymax=yrng[2],data=presidential)
j
j+scale_fill_manual(values=alpha(c("blue","red"),.3))
```
## Aesthetics : grouping
grouping could be specified by aes(col,fill,shape,linetype) or with facets
```{r}
p<-ggplot(mtcars,aes(wt,mpg))
# A basic scatter
p+geom_point(size=4)
# color aethetic
p+geom_point(aes(colour=factor(cyl)),size=4,alpha=.1)
# shape to distinguish the data
p+geom_point(aes(shape=factor(cyl)), size=4)

# using fill
a<-ggplot(mtcars,aes(factor(cyl)))
a+geom_bar()
a+geom_bar(aes(fill=factor(cyl)))

#using linetypes
rescale01<-function(x) (x-min(x))/diff(range(x))
ec_scaled<-data.frame(date=economics$date,plyr::colwise(rescale01)(economics[,-(1:2)]))
ecm<-reshape2::melt(ec_scaled,id.vars="date")
f<- ggplot(ecm,aes(date,value)) 
f + geom_line(aes(linetype=variable))

# using facets
k<-ggplot(diamonds,aes(carat,stat(density))) + geom_histogram(binwidth = .2)
k+facet_grid(.~cut)
# multiple groups with one aesthetic
h<-ggplot(nlme::Oxboys,aes(age,height))
# a single line tries to connect all observation
h+geom_line() #bad
# group aesthetic maps different  line for each suject
h+geom_line(aes(group=Subject))
# different groups on different layers
h<-h+geom_line(aes(group=Subject))
h+geom_smooth(aes(group=Subject),method="lm",se=F)
#changing the group aesthetic for the smoother layer
# fits a single line of best fit across all boys
h+geom_smooth(aes(group=1),size=2,method="lm",se=F)

# overriding the default grouping-- e.g boxplot of height at each measurement occassion
boysbox<-ggplot(nlme::Oxboys,aes(Occasion,height))
boysbox+geom_boxplot()

```

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
